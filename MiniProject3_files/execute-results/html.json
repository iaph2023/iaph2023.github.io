{
  "hash": "8bb4812b9a25d4e5af52fbad69edc635",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Mini Project 3 Final\"\ndescription: |\n  Analyzing NCAA Home-Court Advantage\nauthor: \"Ian Palmer\"\ndate: 11/08/24\nexecute: \n  warning: false\n  message: false\n---\n\n*Analysis Plan:*<br>\n\nTo test whether home-court advantage has a measurable effect on win percentages, we’ll calculate the observed difference in median win percentage between home and away games across all NCAA men's basketball teams in our dataset. To determine if this observed difference could happen by chance, we’ll use a permutation test. Specifically, we’ll shuffle the \"home\" and \"away\" labels for each team multiple times and calculate the median difference in win percentages after each shuffle. By comparing our observed difference to this distribution of permuted differences, we can assess whether any observed effect is statistically significant.\n\nThe result will show whether the median win percentage difference between home and away games is greater than what we’d expect by random chance alone. A low p-value would suggest that the difference is meaningful and likely due to a true home-court advantage.\n\n*Data Source:*<br>\n\nThe data used in this analysis comes from a Kaggle dataset by Nishaan Amin, titled March Madness Data, which includes statistics on NCAA men's basketball tournament teams from 2008 to 2024 (excluding 2020, as the tournament was canceled due to COVID-19). Specifically, we used two files: Barttorvik Home.csv and Barttorvik Away.csv, which provide team statistics for home and away games. These files were sourced from [Barttorvik’s college basketball data](https://www.barttorvik.com/#). The full dataset is available on Kaggle: [Home file](https://www.kaggle.com/datasets/nishaanamin/march-madness-data/data?select=Barttorvik+Home.csv) and [Away file](https://www.kaggle.com/datasets/nishaanamin/march-madness-data/data?select=Barttorvik+Away.csv).\n\n\nBelow is the original data:\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n# Original Data\nhome_data <- read.csv(\"Barttorvik Home.csv\")\naway_data <- read.csv(\"Barttorvik Away.csv\")\n```\n:::\n\nI loaded the data files, which provided team names and their respective winning percentages (WIN.) for home and away games. The data required some cleaning and restructuring to make it suitable for analysis.\n\n*Visualizing the Original Data*<br>\nBefore diving into the analysis, it’s important to understand how win percentages differ between home and away games. To do this, I created a boxplot that compares the distributions of win percentages for home and away games. The boxplot provides a summary of the data by showing the median, interquartile range (IQR), and potential outliers for each location.\n\nBy visualizing the data in this way, we can see how performance at home differs from performance away, highlighting trends in win percentage distributions and helping to establish a foundation for further analysis. Below is the resulting boxplot.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Boxplot comparing home and away win percentages\ncombined_data <- bind_rows(\n  home_data |> \n    mutate(location = \"Home\"),\n  away_data |> \n    mutate(location = \"Away\")\n)\n\nggplot(combined_data, aes(x = location, y = WIN., fill = location)) +\n  geom_boxplot() +\n  labs(\n    title = \"Distribution of Win Percentages by Location\",\n    x = \"Game Location\",\n    y = \"Win Percentage\"\n  ) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](MiniProject3_files/figure-html/unnamed-chunk-2-1.png){fig-alt='Boxplot comparing win percentages for NCAA teams by game location. The left box represents away games, showing a lower median win percentage and a tighter distribution, while the right box represents home games, showing a higher median win percentage with a wider range and several outliers below the lower whisker. The chart emphasizes the significant difference in performance between home and away games.' width=672}\n:::\n:::\n\nWe can see that the boxplot shows that teams tend to perform better at home than away, as indicated by the higher median win percentage for home games. The distribution of home win percentages is also wider, with more variability compared to away games, which tend to cluster around lower values. This suggests a significant home-court advantage in NCAA basketball games.<br>\n\nTo further explore this trend and prepare for a more detailed analysis, I needed to clean and organize the data. By calculating summary statistics and structuring the data appropriately, I ensured it was ready for robust hypothesis testing and visualization. Below are the steps I took to wrangle the data.\n\n\n*Date Wrangling*<br>\nHere, I selected the relevant columns, renamed them for clarity, and added a column to indicate whether the data corresponded to home or away games. I also grouped the data by team and location to calculate the median win percentage for each group.\n\n::: {.cell}\n\n```{.r .cell-code}\n#Reload original data to avoid values getting changed\nhome_data <- read.csv(\"Barttorvik Home.csv\")\naway_data <- read.csv(\"Barttorvik Away.csv\")\n\n# Select relevant columns and rename for clarity\n# Add a \"location\" column to distinguish between home and away games\nhome_data <- home_data |>\n  select(TEAM, WIN.) |>\n  rename(win_pct = WIN.) |>\n  mutate(location = \"home\")\n\naway_data <- away_data |>\n  select(TEAM, WIN.) |>\n  rename(win_pct = WIN.) |>\n  mutate(location = \"away\")\n\n#Group by TEAM and Location, Calculate Median Win Percentage\nhome_median <- home_data |>\n  group_by(TEAM, location) |>\n  summarise(median_win_pct = median(win_pct, na.rm = TRUE))\n\naway_median <- away_data |>\n  group_by(TEAM, location) |>\n  summarise(median_win_pct = median(win_pct, na.rm = TRUE))\n\n# Combine Home and Away Results\ncombined_median_data <- bind_rows(home_median, away_median)\n```\n:::\n\n\nHere is a quick summary of the results found above, sorted by location.\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calculate the median win percentages for home and away\nlocation_medians <- combined_median_data |>\n  group_by(location) |>\n  summarise(median_win_pct = median(median_win_pct, na.rm = TRUE))\n\n# Print the results\nlocation_medians\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 2\n  location median_win_pct\n  <chr>             <dbl>\n1 away               54.5\n2 home               85.7\n```\n\n\n:::\n:::\n\n\n\nNext, we can calculate the observed difference in median win percentage. This will show us the perceved advantage of playing at home compared to playing away.\n\n::: {.cell}\n\n```{.r .cell-code}\n#Calculate the Observed Difference in Median Win Percentage\nobserved_diff <- combined_median_data |>\n  group_by(location) |>\n  summarise(median_win_pct = median(median_win_pct, na.rm = TRUE)) |>\n  summarise(diff = diff(median_win_pct)) |>\n  pull(diff)\n\ncat(\"Observed Difference in Median Win Percentage (Home - Away):\", observed_diff, \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nObserved Difference in Median Win Percentage (Home - Away): 31.16884 \n```\n\n\n:::\n:::\n\nFrom here we get a value of around 31%. This means that for NCAA mens basketball from 2008-2024 there was 31% more wins when playing at home compared to away.\n\n\nIn order to see if this result is statistically significant I chose to perform a hypothesis test using a permutation function. Using 10000 random samples I shuffled the location of each team in order to make the win percentage uncorrelated with location. We then can compare our original observed difference of 31% to the distribution of randomized outcomes. This will return a two sided P-value.\n\n::: {.cell}\n\n```{.r .cell-code}\n# Define Permutation Function (Shuffling location within each team)\ncalculate_permutation <- function(data) {\n  data |>\n    group_by(TEAM) |>\n    mutate(location = sample(location, replace = FALSE)) |>\n    group_by(location) |>\n    summarise(median_win_pct = median(median_win_pct, na.rm = TRUE)) |>\n    summarise(diff = diff(median_win_pct)) |>\n    pull(diff)\n}\n#Permutation Test\nnum_permutations <- 10000\nperm_results <- map_dbl(1:num_permutations, ~ calculate_permutation(combined_median_data))\n\n# Calculate the two-sided p-value\np_value <- mean(abs(perm_results) >= abs(observed_diff))\ncat(\"Two-Sided P-value:\", p_value, \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nTwo-Sided P-value: 0 \n```\n\n\n:::\n:::\n\nA P-value of 0 implies that it is statistically impossible for the observed difference to have occurred by chance. Or in other words, in the 10000 samples that we conducted none of the observed differences were greater than 31%.\n\n\nFinally, I used a histogram to visulize the permuted distribution and compared it to the observed difference.\n\n::: {.cell}\n\n```{.r .cell-code}\n# Histogram of Permuted Differences with the Observed Difference\nggplot(data.frame(perm_results), aes(x = perm_results)) +\n  geom_histogram(bins = 30, color = \"black\", fill = \"skyblue\") +\n  geom_vline(xintercept = observed_diff, color = \"red\", linetype = \"dashed\", linewidth = 1.2) +\n  labs(\n    title = \"Permutation Test: Distribution of Permuted Differences\",\n    x = \"Difference in Median Win Percentage (Home  - Away)\",\n    y = \"Frequency\"\n  )\n```\n\n::: {.cell-output-display}\n![](MiniProject3_files/figure-html/unnamed-chunk-7-1.png){fig-alt='Histogram displaying the distribution of permuted differences in median win percentages (Home - Away) for NCAA basketball teams. The x-axis shows the difference in win percentages, while the y-axis represents the frequency of these differences across 10,000 permutations. The red dashed line marks the observed difference of approximately 31%, which lies far to the right of the distribution, indicating that the observed difference is highly unlikely under the null hypothesis of no true difference between home and away win percentages.' width=672}\n:::\n:::\n\n\n*Explanation of Plot:*<br>\n\nThe histogram shows the distribution of permuted differences in median win percentages between home and away games, simulating what we’d expect to see under the null hypothesis (no real difference between home and away performance). Each bar represents the frequency of permuted differences from our 1,000 random shuffles of the home and away labels. The red dashed line on the far right marks the observed difference in median win percentage, which is approximately 31.17%.\n\n\n*Summary of Findings:*<br>\n\nThe observed difference in median win percentages between home and away games is 31.17%, indicating that teams tend to perform better at home by a substantial margin. The two-sided p-value of 0 confirms that this observed difference is highly statistically significant. None of the permuted differences reached or exceeded the observed value, strongly suggesting that the observed home-court advantage is not due to random variation.\n\nThis analysis provides strong evidence that playing at home has a positive and significant impact on NCAA teams' win percentages. Factors such as crowd support, familiarity with the environment, and the absence of travel fatigue may contribute to this advantage. The findings show that home-court advantage is likely a real and influential factor in game outcomes.\n\n*Discussion: Generalizability of Results*<br>\nThis analysis highlights a significant home-court advantage in NCAA men's basketball, with a 31% higher median win percentage for home games compared to away games. While this result is statistically significant within the scope of the dataset, it is important to consider its generalizability. The dataset spans 2008–2024 and includes a subset of NCAA teams. These findings probably could be extended to other NCAA teams under similar conditions but may not fully capture the variability across different leagues, sports, or time periods. Further research is needed to determine whether the magnitude of home-court advantage is consistent across other contexts.",
    "supporting": [
      "MiniProject3_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}